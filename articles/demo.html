<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="GeoPressureR">
<title>demo • GeoPressureR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="demo">
<meta property="og:description" content="GeoPressureR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">GeoPressureR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-2">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/demo.html">demo</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">
<script src="demo_files/htmlwidgets-1.5.4/htmlwidgets.js"></script><script src="demo_files/jquery-1.12.4/jquery.min.js"></script><link href="demo_files/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="demo_files/leaflet-1.3.1/leaflet.js"></script><link href="demo_files/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="demo_files/proj4-2.6.2/proj4.min.js"></script><script src="demo_files/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="demo_files/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="demo_files/leaflet-binding-2.0.4.1/leaflet.js"></script><div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>demo</h1>
            
      
      
      <div class="d-none name"><code>demo.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<p>For this demo, we will use the standard packages for processing the raw geolocator data. If you haven’t installed them, use the following lines:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/remote-reexports.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"GeoPressureR"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">GeoPressureR</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/raster" class="external-link">raster</a></span><span class="op">)</span>
<span class="co">#&gt; Loading required package: sp</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://rgdal.r-forge.r-project.org" class="external-link">rgdal</a></span><span class="op">)</span>
<span class="co">#&gt; Please note that rgdal will be retired by the end of 2023,</span>
<span class="co">#&gt; plan transition to sf/stars/terra functions using GDAL and PROJ</span>
<span class="co">#&gt; at your earliest convenience.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; rgdal: version: 1.5-27, (SVN revision 1148)</span>
<span class="co">#&gt; Geospatial Data Abstraction Library extensions to R successfully loaded</span>
<span class="co">#&gt; Loaded GDAL runtime: GDAL 3.2.1, released 2020/12/29</span>
<span class="co">#&gt; Path to GDAL shared files: /Library/Frameworks/R.framework/Versions/4.1/Resources/library/rgdal/gdal</span>
<span class="co">#&gt; GDAL binary built with GEOS: TRUE </span>
<span class="co">#&gt; Loaded PROJ runtime: Rel. 7.2.1, January 1st, 2021, [PJ_VERSION: 721]</span>
<span class="co">#&gt; Path to PROJ shared files: /Library/Frameworks/R.framework/Versions/4.1/Resources/library/rgdal/proj</span>
<span class="co">#&gt; PROJ CDN enabled: FALSE</span>
<span class="co">#&gt; Linking to sp version:1.4-5</span>
<span class="co">#&gt; To mute warnings of possible GDAL/OSR exportToProj4() degradation,</span>
<span class="co">#&gt; use options("rgdal_show_exportToProj4_warnings"="none") before loading sp or rgdal.</span>
<span class="co">#&gt; Overwritten PROJ_LIB was /Library/Frameworks/R.framework/Versions/4.1/Resources/library/rgdal/proj</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rstudio.github.io/leaflet/" class="external-link">leaflet</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="load-data">Load data<a class="anchor" aria-label="anchor" href="#load-data"></a>
</h2>
<p>Load the hoopoe data and set the basic information for this track</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#print(system.file("extdata", "/", package = "GeoPressureR"))</span>
<span class="va">PAM_data</span> <span class="op">=</span> <span class="fu"><a href="../reference/create_import.html">create_import</a></span><span class="op">(</span>pathname <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"/"</span>, package <span class="op">=</span> <span class="st">"GeoPressureR"</span><span class="op">)</span> <span class="op">)</span>
<span class="va">lon.calib</span> <span class="op">=</span> <span class="fl">17.05</span>   
<span class="va">lat.calib</span> <span class="op">=</span> <span class="fl">48.9</span>
<span class="va">crop.start</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="st">"2017-06-20"</span>,<span class="st">"%Y-%m-%d"</span>, tz<span class="op">=</span><span class="st">"UTC"</span><span class="op">)</span>
<span class="va">crop.end</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="st">"2018-05-01"</span>,<span class="st">"%Y-%m-%d"</span>, tz<span class="op">=</span><span class="st">"UTC"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="activity-processing">Activity Processing<a class="anchor" aria-label="anchor" href="#activity-processing"></a>
</h2>
<p>Using PalmR package, we crop the data and classify the activity. See more possible classification on <a href="https://kiranlda.github.io/PAMLrManual/index.html" class="external-link uri">https://kiranlda.github.io/PAMLrManual/index.html</a></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">PAM_data</span> <span class="op">=</span> <span class="fu"><a href="../reference/create_crop.html">create_crop</a></span><span class="op">(</span><span class="va">PAM_data</span>,<span class="va">crop.start</span>,<span class="va">crop.end</span><span class="op">)</span>
<span class="va">behaviour</span> <span class="op">=</span> <span class="fu"><a href="../reference/classify_flap.html">classify_flap</a></span><span class="op">(</span><span class="va">PAM_data</span><span class="op">$</span><span class="va">acceleration</span>, period <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>
<span class="va">PAM_data</span><span class="op">$</span><span class="va">acceleration</span><span class="op">$</span><span class="va">class</span> <span class="op">=</span> <span class="va">behaviour</span><span class="op">$</span><span class="va">classification</span><span class="op">==</span><span class="fl">3</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="editing-of-pressure-and-activity-on-trainset">Editing of Pressure and Activity on Trainset<a class="anchor" aria-label="anchor" href="#editing-of-pressure-and-activity-on-trainset"></a>
</h2>
<p>For the matching of pressure to work correctly, we need that the bird was exactly at the same location during the stationary period. It is very likely that a manual editing of the activity classification is required.</p>
<p>We suggest using TRAINNSET to edit your classification. The following code will export the automatically generated classification. It can be editted on TRAINSET, then export it back into.</p>
<p>Make sure to keep these classified file on your project folder (e.g. under <code>/data/</code>)</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">PAM_data</span> <span class="op">=</span> <span class="fu"><a href="../reference/trainset.edit.html">trainset.edit</a></span><span class="op">(</span><span class="va">PAM_data</span>, file.location<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"/"</span>, package <span class="op">=</span> <span class="st">"GeoPressureR"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>To re-edit an existing labeled file you can simply re-open the file on <a href="https://trainset.geocene.com/" class="external-link">trainset.geocene.com</a> and read this file with <code>trainset.read</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># browseURL("https://trainset.geocene.com/")</span>
<span class="va">PAM_data</span> <span class="op">=</span> <span class="fu"><a href="../reference/trainset.read.html">trainset.read</a></span><span class="op">(</span><span class="va">PAM_data</span>, file.location<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"/"</span>, package <span class="op">=</span> <span class="st">"GeoPressureR"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>I will write another vignette on the best practice to label activity and pressure data.</p>
</div>
<div class="section level2">
<h2 id="activity-to-stationary-period">Activity to stationary period<a class="anchor" aria-label="anchor" href="#activity-to-stationary-period"></a>
</h2>
<p>Build a data.frame of the stationary period.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sta</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>
  start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">crop.start</span>,<span class="va">behaviour</span><span class="op">$</span><span class="va">timetable</span><span class="op">$</span><span class="va">end</span><span class="op">)</span>,
  end <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">behaviour</span><span class="op">$</span><span class="va">timetable</span><span class="op">$</span><span class="va">start</span>,<span class="va">crop.end</span><span class="op">)</span>,
  nextFlightDuration <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">behaviour</span><span class="op">$</span><span class="va">timetable</span><span class="op">$</span><span class="va">`Duration (h)`</span>,<span class="fl">0</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">sta</span><span class="op">$</span><span class="va">staID</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/ncell.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sta</span><span class="op">)</span></code></pre></div>
<p>Assign to each pressure measure the stationary period to which it belong to.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">staID</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">PAM_data</span><span class="op">$</span><span class="va">pressure</span><span class="op">$</span><span class="va">date</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">sta</span><span class="op">$</span><span class="va">start</span><span class="op">&lt;=</span><span class="va">x</span> <span class="op">&amp;</span> <span class="va">x</span><span class="op">&lt;=</span><span class="va">sta</span><span class="op">$</span><span class="va">end</span><span class="op">)</span><span class="op">)</span>
<span class="va">staID</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">staID</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="fl">0</span>
<span class="va">PAM_data</span><span class="op">$</span><span class="va">pressure</span><span class="op">$</span><span class="va">staID</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">staID</span><span class="op">)</span></code></pre></div>
<p>Initially, it might be easier to only query stationary period of a certain duration.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">min_duration</span> <span class="op">=</span> <span class="fl">60</span><span class="op">*</span><span class="fl">24</span><span class="op">*</span><span class="fl">16</span> <span class="co"># in minutes</span>
<span class="va">staID_keep</span> <span class="op">=</span> <span class="va">sta</span><span class="op">$</span><span class="va">staID</span><span class="op">[</span><span class="op">(</span><span class="va">sta</span><span class="op">$</span><span class="va">end</span><span class="op">-</span><span class="va">sta</span><span class="op">$</span><span class="va">start</span><span class="op">)</span><span class="op">&gt;</span><span class="va">min_duration</span><span class="op">]</span>
<span class="va">PAM_data</span><span class="op">$</span><span class="va">pressure</span><span class="op">$</span><span class="va">staID</span><span class="op">[</span><span class="op">!</span><span class="op">(</span><span class="va">PAM_data</span><span class="op">$</span><span class="va">pressure</span><span class="op">$</span><span class="va">staID</span> <span class="op"><a href="https://rdrr.io/pkg/raster/man/match.html" class="external-link">%in%</a></span> <span class="va">staID_keep</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="cn">NA</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="request-map-of-pressure">Request map of pressure<a class="anchor" aria-label="anchor" href="#request-map-of-pressure"></a>
</h2>
<p>In this part, we query the maps of pressure from the GeoPressure API (<a href="https://github.com/Rafnuss/GeoPressureServer/" class="external-link">see more information on github.com/Rafnuss/GeoPressureServer/</a>). See details explanation of the parameter on <a href="https://github.com/Rafnuss/GeoPressureServer/#request" class="external-link uri">https://github.com/Rafnuss/GeoPressureServer/#request</a></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>extent <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">6</span>,<span class="dv">26</span>,<span class="dv">4</span>,<span class="dv">53</span>) <span class="co"># coordinates of the map to request (W,E,S,N) </span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>scale <span class="ot">=</span> <span class="dv">1</span> <span class="co"># request on a 1° grid to make the code faster</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>maxSample <span class="ot">=</span> <span class="dv">20</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>margin <span class="ot">=</span> <span class="dv">30</span> <span class="co"># roughly equivalent to 3hPa</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>rasterList <span class="ot">=</span> <span class="fu">geopressure.map</span>(PAM_data<span class="sc">$</span>pressure, <span class="at">extent=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">16</span>,<span class="dv">20</span>,<span class="dv">0</span>,<span class="dv">50</span>), <span class="at">scale=</span>scale, <span class="at">maxSample=</span>maxSample, <span class="at">margin=</span>margin)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Sending requests...</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Request generated successfully for 5 stationary periods (1, 5, 16, 19, 28, )</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Starting download:</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>[<span class="sc">==</span><span class="er">========</span>                                        ] <span class="dv">1</span> <span class="sc">/</span> <span class="dv">5</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>[<span class="sc">==</span><span class="er">==================</span>                              ] <span class="dv">2</span> <span class="sc">/</span> <span class="dv">5</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>[<span class="sc">==</span><span class="er">============================</span>                    ] <span class="dv">3</span> <span class="sc">/</span> <span class="dv">5</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>[<span class="sc">==</span><span class="er">======================================</span>          ] <span class="dv">4</span> <span class="sc">/</span> <span class="dv">5</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>[<span class="sc">==</span><span class="er">================================================</span>] <span class="dv">5</span> <span class="sc">/</span> <span class="dv">5</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Receiving download (geotiff):</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>[<span class="sc">==</span><span class="er">========</span>                                        ] <span class="dv">1</span> <span class="sc">/</span> <span class="dv">5</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>[<span class="sc">==</span><span class="er">==================</span>                              ] <span class="dv">2</span> <span class="sc">/</span> <span class="dv">5</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>[<span class="sc">==</span><span class="er">============================</span>                    ] <span class="dv">3</span> <span class="sc">/</span> <span class="dv">5</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>[<span class="sc">==</span><span class="er">======================================</span>          ] <span class="dv">4</span> <span class="sc">/</span> <span class="dv">5</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>[<span class="sc">==</span><span class="er">================================================</span>] <span class="dv">5</span> <span class="sc">/</span> <span class="dv">5</span></span></code></pre></div>
<p>Compute probability map</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">s</span> <span class="op">=</span> <span class="fl">0.4</span> <span class="co"># standard deviation of pressure</span>
<span class="va">thr</span> <span class="op">=</span> <span class="fl">0.9</span> <span class="co"># threashold of value acceptable 2</span>
<span class="va">rasterProbList</span> <span class="op">=</span> <span class="fu"><a href="../reference/geopressure.Probmap.html">geopressure.Probmap</a></span><span class="op">(</span><span class="va">rasterList</span>, s<span class="op">=</span><span class="va">s</span>, thr<span class="op">=</span><span class="va">thr</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="display">Display<a class="anchor" aria-label="anchor" href="#display"></a>
</h2>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">i_r</span> <span class="op">=</span> <span class="fl">1</span>;

<span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/leaflet.html" class="external-link">leaflet</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/leaflet/man/leaflet-imports.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/map-layers.html" class="external-link">addTiles</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/leaflet/man/leaflet-imports.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/addRasterImage.html" class="external-link">addRasterImage</a></span><span class="op">(</span><span class="va">rasterProbList</span><span class="op">[[</span><span class="va">i_r</span><span class="op">]</span><span class="op">]</span>, opacity <span class="op">=</span> <span class="fl">0.8</span>, group<span class="op">=</span><span class="st">"Probability"</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/leaflet/man/leaflet-imports.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/addRasterImage.html" class="external-link">addRasterImage</a></span><span class="op">(</span><span class="va">rasterList</span><span class="op">[[</span><span class="va">i_r</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, opacity <span class="op">=</span> <span class="fl">0.8</span>, group<span class="op">=</span><span class="st">"Mismatch"</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/leaflet/man/leaflet-imports.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/addRasterImage.html" class="external-link">addRasterImage</a></span><span class="op">(</span><span class="va">rasterList</span><span class="op">[[</span><span class="va">i_r</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, opacity <span class="op">=</span> <span class="fl">0.8</span>, group<span class="op">=</span><span class="st">"Threashold"</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/leaflet/man/leaflet-imports.html" class="external-link">%&gt;%</a></span>
  <span class="co"># addLegend(pal = pal, values = values(v[[i_s]][[3]]), title = "Probability") %&gt;% </span>
  <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/addLayersControl.html" class="external-link">addLayersControl</a></span><span class="op">(</span>
    overlayGroups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Probability"</span>,<span class="st">"Mismatch"</span>,<span class="st">"Threashold"</span><span class="op">)</span>,
    options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/addLayersControl.html" class="external-link">layersControlOptions</a></span><span class="op">(</span>collapsed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/leaflet/man/leaflet-imports.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/showGroup.html" class="external-link">hideGroup</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Mismatch"</span>,<span class="st">"Threashold"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO", prefer_proj =</span>
<span class="co">#&gt; prefer_proj): Discarded ellps WGS 84 in Proj4 definition: +proj=merc +a=6378137</span>
<span class="co">#&gt; +b=6378137 +lat_ts=0 +lon_0=0 +x_0=0 +y_0=0 +k=1 +units=m +nadgrids=@null</span>
<span class="co">#&gt; +wktext +no_defs +type=crs</span>
<span class="co">#&gt; Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO", prefer_proj =</span>
<span class="co">#&gt; prefer_proj): Discarded datum World Geodetic System 1984 in Proj4 definition</span></code></pre></div>
<div id="htmlwidget-d01dc4a443e10f87962d" style="width:700px;height:432.632880098888px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-d01dc4a443e10f87962d">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addRasterImage","args":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAyCAYAAAA0j3keAAABNElEQVRYhe2ZPRKCMBBGPxwrbGyktfUadjR6BMZbeB+8ggWl5+ECzjg4WoXJZEJ2SQjZIq9jgOxjNz8ECjDpm/rHvXYOz8cH50uJ3X4AAGxiBJnD63rD8X4aj9lCVdsVMYTehxIYvuOxV5BY5QMElMwkC1FM9qGY/cSFNUNLybhGZtV2he289YYQIT2ITzvi+pBVyHcS9CkRS8gXTokosUX7kC1Q39Q/ql/p54OHPacMSmqqTb2NLScoJyDnOpeUYtWJ0VY6M8Os0bTGRKlwlizF8pFsLZvK1uJLhw/ksE+10gMC1zLrzJpCRFFIkNCRVzJJ2QEEZigLUWQhiixEkYUoshBFFqIQJ5Rf0CiCvnbFQOZLvomPlNrshT5Q0FZ6ajscIhXlh4rOXLmoo8z8nMdBXIb+j+iIlpMXgp0AAAAASUVORK5CYII=",[[50,-16],[2.61444157257071e-16,20]],0.8,null,null,"Probability"]},{"method":"addRasterImage","args":["data:image/png;base64,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",[[50,-16],[2.61444157257071e-16,20]],0.8,null,null,"Mismatch"]},{"method":"addRasterImage","args":["data:image/png;base64,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",[[50,-16],[2.61444157257071e-16,20]],0.8,null,null,"Threashold"]},{"method":"addLayersControl","args":[[],["Probability","Mismatch","Threashold"],{"collapsed":false,"autoZIndex":true,"position":"topright"}]},{"method":"hideGroup","args":[["Mismatch","Threashold"]]}],"limits":{"lat":[2.61444157257071e-16,50],"lng":[-16,20]}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level2">
<h2 id="check-pressure-match">Check pressure match<a class="anchor" aria-label="anchor" href="#check-pressure-match"></a>
</h2>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">i_r</span><span class="op">=</span><span class="fl">1</span>

<span class="va">i_s</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/metadata.html" class="external-link">metadata</a></span><span class="op">(</span><span class="va">rasterProbList</span><span class="op">[[</span><span class="va">i_r</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="va">staID</span>

<span class="co"># find the max value of probability</span>
<span class="va">tmp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">rasterProbList</span><span class="op">[[</span><span class="va">i_r</span><span class="op">]</span><span class="op">]</span>,xy<span class="op">=</span><span class="cn">T</span><span class="op">)</span>
<span class="va">lon</span> <span class="op">=</span> <span class="va">tmp</span><span class="op">$</span><span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/which.minmax.html" class="external-link">which.max</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">]</span>
<span class="va">lat</span> <span class="op">=</span> <span class="va">tmp</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/which.minmax.html" class="external-link">which.max</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">]</span>

<span class="co"># filter pressure for the stationary period</span>
<span class="co"># include flight period before and after</span>
<span class="va">pres</span> <span class="op">=</span> <span class="va">PAM_data</span><span class="op">$</span><span class="va">pressure</span>
<span class="va">id</span> <span class="op">=</span> <span class="va">pres</span><span class="op">$</span><span class="va">staID</span><span class="op">==</span><span class="va">i_s</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">pres</span><span class="op">$</span><span class="va">staID</span><span class="op">)</span>
<span class="va">pressure</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
  obs <span class="op">=</span> <span class="va">pres</span><span class="op">$</span><span class="va">obs</span><span class="op">[</span><span class="va">id</span><span class="op">]</span>,
  date <span class="op">=</span> <span class="va">pres</span><span class="op">$</span><span class="va">date</span><span class="op">[</span><span class="va">id</span><span class="op">]</span>
<span class="op">)</span>

<span class="co"># query the pressure at this location</span>
<span class="va">ptsr</span>  <span class="op">=</span> <span class="fu"><a href="../reference/geopressure.timeseries.html">geopressure.timeseries</a></span><span class="op">(</span><span class="va">lon</span>, <span class="va">lat</span>, pressure <span class="op">=</span> <span class="va">pressure</span><span class="op">)</span>
<span class="co">#&gt; Sending requests...</span>
<span class="co">#&gt; Request generated successfully.</span>
<span class="co">#&gt; Downloading csv data.</span></code></pre></div>
<p>Visualize</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">pressure</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">date</span>,y<span class="op">=</span><span class="va">obs</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">ptsr</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">date</span>,y<span class="op">=</span><span class="va">pressure</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="demo_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
</div>
<div class="section level1">
<h1 id="combine-with-light">Combine with Light<a class="anchor" aria-label="anchor" href="#combine-with-light"></a>
</h1>
<p>Standard processure following <a href="https://geolocationmanual.vogelwarte.ch/twilight.html" class="external-link uri">https://geolocationmanual.vogelwarte.ch/twilight.html</a> Get the twilight</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#twl = twilightCalc(PAM_data$light$date, PAM_data$light$obs, LightThreshold = 2, ask = F)</span></code></pre></div>
<p>Calibraiton</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># d.calib = subset(twl, (tSecond&lt;=head(behaviour$timetable$start,1)) | </span>
<span class="co">#                        (tFirst&gt;=tail(behaviour$timetable$end,1)))</span>
<span class="co"># </span>
<span class="co"># gE = getElevation(twl = d.calib, known.coord = c(lon.calib, lat.calib),method = "gamma", plot = F)</span>
<span class="co"># </span>
<span class="co"># crds = coord(twl, degElevation = 90-gE[1], note = FALSE)</span>
<span class="co"># tripMap(crds)</span>
<span class="co"># points(lon.calib, lat.calib, pch = 21, cex = 1.5, bg = "white") # adding the release location</span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Rapaël Nussbaumer, Mathieu Gravey.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
