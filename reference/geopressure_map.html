<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="The geopressure_map() function computes a likelihood map for each stationary period based on
pressure measurements. It is a wrapper of the following two child functions:
geopressure_map_mismatch() computes the mismatch maps between the pressure sensor
measurements and the ERA5 reanalysis database.
geopressure_map_likelihood() converts the mismatch maps into a likelihood map.


See below for details.For more background on the method behind these functions, please refer to
Nussbaumer et al. (2023a)."><title>Compute likelihood map from pressure data — geopressure_map • GeoPressureR</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute likelihood map from pressure data — geopressure_map"><meta property="og:description" content="The geopressure_map() function computes a likelihood map for each stationary period based on
pressure measurements. It is a wrapper of the following two child functions:
geopressure_map_mismatch() computes the mismatch maps between the pressure sensor
measurements and the ERA5 reanalysis database.
geopressure_map_likelihood() converts the mismatch maps into a likelihood map.


See below for details.For more background on the method behind these functions, please refer to
Nussbaumer et al. (2023a)."><meta property="og:image" content="https://raphaelnussbaumer.com/GeoPressureR/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=M5FY4BPHTB"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'M5FY4BPHTB');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">GeoPressureR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">3.2.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Rafnuss/GeoPressureR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Compute likelihood map from pressure data</h1>
      <small class="dont-index">Source: <a href="https://github.com/Rafnuss/GeoPressureR/blob/HEAD/R/geopressure_map.R" class="external-link"><code>R/geopressure_map.R</code></a>, <a href="https://github.com/Rafnuss/GeoPressureR/blob/HEAD/R/geopressure_map_likelihood.R" class="external-link"><code>R/geopressure_map_likelihood.R</code></a>, <a href="https://github.com/Rafnuss/GeoPressureR/blob/HEAD/R/geopressure_map_mismatch.R" class="external-link"><code>R/geopressure_map_mismatch.R</code></a></small>
      <div class="d-none name"><code>geopressure_map.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The <code>geopressure_map()</code> function computes a likelihood map for each stationary period based on
pressure measurements. It is a wrapper of the following two child functions:</p><ol><li><p><code>geopressure_map_mismatch()</code> computes the mismatch maps between the pressure sensor
measurements and the ERA5 reanalysis database.</p></li>
<li><p><code>geopressure_map_likelihood()</code> converts the mismatch maps into a likelihood map.</p></li>
</ol><p>See below for details.For more background on the method behind these functions, please refer to
Nussbaumer et al. (<a href="https://doi.org/10.1111/2041-210X.14043" class="external-link">2023a</a>).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">geopressure_map</span><span class="op">(</span></span>
<span>  <span class="va">tag</span>,</span>
<span>  max_sample <span class="op">=</span> <span class="fl">250</span>,</span>
<span>  margin <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  sd <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  thr_mask <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  log_linear_pooling_weight <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">/</span><span class="va">n</span>,</span>
<span>  timeout <span class="op">=</span> <span class="fl">60</span> <span class="op">*</span> <span class="fl">5</span>,</span>
<span>  workers <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  keep_mask <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  keep_mse <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  compute_known <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  debug <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">geopressure_map_likelihood</span><span class="op">(</span></span>
<span>  <span class="va">tag</span>,</span>
<span>  sd <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  log_linear_pooling_weight <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">/</span><span class="va">n</span>,</span>
<span>  keep_mse <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">geopressure_map_mismatch</span><span class="op">(</span></span>
<span>  <span class="va">tag</span>,</span>
<span>  max_sample <span class="op">=</span> <span class="fl">250</span>,</span>
<span>  margin <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  keep_mask <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  thr_mask <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  timeout <span class="op">=</span> <span class="fl">60</span> <span class="op">*</span> <span class="fl">5</span>,</span>
<span>  workers <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  compute_known <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  debug <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>tag</dt>
<dd><p>a GeoPressureR <code>tag</code> object</p></dd>


<dt>max_sample</dt>
<dd><p>the computation of the maps is only performed on <code>max_sample</code> datapoints of
pressure to reduce computational time. The samples are randomly (uniformly) selected on the
time series.</p></dd>


<dt>margin</dt>
<dd><p>the margin is used in the mask map to accept measurement errors, small-scale
topography, and vertical movements of the bird (unit in meters, 1hPa~10m).</p></dd>


<dt>sd</dt>
<dd><p>standard deviation of the pressure error . numeric of length 1 or number of stationary
periods.</p></dd>


<dt>thr_mask</dt>
<dd><p>threshold of the percentage of data points outside the elevation range to be
considered not possible.</p></dd>


<dt>log_linear_pooling_weight</dt>
<dd><p>weighting function of the log-linear pooling, taking the number
of samples of the stationary periods used and returning the weight of the aggregation. See
<a href="https://raphaelnussbaumer.com/GeoPressureManual/probability-aggregation.html" class="external-link">GeoPressureManual | Probability aggregation </a> for more details.</p></dd>


<dt>timeout</dt>
<dd><p>duration before the code is interrupted both for the request on
GeoPressureAPI and on GEE (in seconds, see <code><a href="https://httr2.r-lib.org/reference/req_timeout.html" class="external-link">httr2::req_timeout()</a></code>).</p></dd>


<dt>workers</dt>
<dd><p>number of parallel requests on GEE. Integer between 1 and 99. <code>"auto"</code> adjust the
number of workers to the number of <code>stapelev</code> to query.</p></dd>


<dt>keep_mask</dt>
<dd><p>logical defining if the mask map is returned in <code>tag</code>.</p></dd>


<dt>keep_mse</dt>
<dd><p>logical defining if the MSE map is returned in <code>tag</code>.</p></dd>


<dt>compute_known</dt>
<dd><p>logical defining if the map(s) for known stationary period should be
estimated based on twilight or hard defined by the known location <code>stap$known_l**</code></p></dd>


<dt>debug</dt>
<dd><p>logical to display additional information to debug a request</p></dd>


<dt>quiet</dt>
<dd><p>logical to hide messages about the progress</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Returns the same GeoPressureR <code>tag</code> object including the GeoPressureR <code>map</code> object
<code>tag$map_pressure</code> containing the likelihood map of each stationary period. See <code><a href="map_create.html">map_create()</a></code></p>


<p>for details.
If <code>keep_mask</code> and <code>keep_mse</code> are each true, <code>tag</code> also includes the <code>tag$map_pressure_mse</code> and
<code>tag$map_pressure_mask</code> maps, as well as <code>tag$stap$nb_sample</code>, indicating the number of
datapoints used to compute the MSE.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>A map will only be computed for the stationary periods included in <code>tag$stap$include</code> and without
a known position <code>tag$stap$known_l**</code> as defined by <code><a href="tag_set_map.html">tag_set_map()</a></code>. At known stationary
periods, the likelihood map is a map of <code>0</code>s with a single <code>1</code> at the pixel closest to the known
position.</p>
    </div>
    <div class="section level2">
    <h2 id="mismatch-map-with-geopressureapi">Mismatch map with GeoPressureAPI<a class="anchor" aria-label="anchor" href="#mismatch-map-with-geopressureapi"></a></h2>
    


<p><code>geopressure_map_mismatch()</code> computes the mismatch maps on Google Earth Engine via the map
entry point of the <a href="https://raphaelnussbaumer.com/GeoPressureAPI/#description" class="external-link">GeoPressure API</a>.
This consists of the following steps:</p><ol><li><p><strong>Pre-process pressure</strong>: the pressure measurements are first smoothed and downscaled to a
1-hour resolution in order to match ERA-5 resolution (see <code><a href="geopressure_map_preprocess.html">geopressure_map_preprocess()</a></code>).</p></li>
<li><p><strong>Generate requests</strong>: Send a single request to the GeoPressureAPI to generate the Google
Earth Engine (GEE) URLs, one for each elevation/stationary period which can be used to compute
the maps on the GEE server.</p></li>
<li><p><strong>Send the requests</strong>: Call the URLs, which will start the computation on the GEE server.
At this step, it does not wait for an answer, but send the requests in parallel to be faster.</p></li>
<li><p><strong>Compute and download the maps</strong>: When all requests are sent, we wait for the GEE server to
return a geotiff file (map) for each elevation/ stationary period.</p></li>
<li><p><strong>Post-process maps</strong>: Read these geotiff maps as matrix, create the corresponding
GeoPressureR <code>map</code> object with <code>create_map()</code>.</p></li>
</ol><p>The following two maps are returned for each stationary period:</p><ol><li><p><strong>map_pressure_mse</strong>: The Mean Square Error (MSE) between the data logger pressure time series
and the reanalysis. The mean error is removed because we assume no specific altitude of the
geolocator, thus allowing an altitudinal shift of the pressure time series.</p></li>
<li><p><strong>map_pressure_mask</strong> (optionally): The mask of the proportion of pressure measurements
corresponding to altitude values found within the min and max ground elevation at each location.
The altitude value of the geolocator pressure time series is computed with the barometric formula
accounting for the temporal variation of pressure (surface-pressure) and temperature
(2m-temperature) based on ERA5 data. The min and max ground elevation of each pixel is computed
from SRTM-90. This map is only returned if <code>keep_mask</code> is <code>TRUE</code>.</p></li>
</ol><p>For more details, read the <a href="https://raphaelnussbaumer.com/GeoPressureAPI/" class="external-link">GeoPressure API documentation </a>.</p>
    </div>
    <div class="section level2">
    <h2 id="elevation-levels">Elevation levels<a class="anchor" aria-label="anchor" href="#elevation-levels"></a></h2>
    


<p>It is possible to indicate different elevation levels when the bird was spending time at
locations with different elevations within a general area (~10km), and thus within the same
stationary period. This can be done by using <code>tag$label="elev_x"</code>for all measurements of the same
elevation level <em>x</em>. See more information on the labelling of elevation levels in <a href="https://raphaelnussbaumer.com/GeoPressureManual/labelling-tracks.html#elevation-period" class="external-link">the corresponding section in the GeoPressureManual</a>.</p>
<p>Behind the scene, each of these elevations levels produce a new requests on the GeoPressureAPI.
The mismatch maps of all elevation levels belonging to the same stationary periods are combined
(as a weighted average) to results in a single mismatch maps per stationary period.</p>
    </div>
    <div class="section level2">
    <h2 id="convert-mismatch-map-into-likelihood-map">Convert mismatch map into likelihood map<a class="anchor" aria-label="anchor" href="#convert-mismatch-map-into-likelihood-map"></a></h2>
    


<p>We convert the map of the mean square error \(MSE\) and altitude mask \(z_{mask}\) computed
by <code>geopressure_map_mismatch()</code> into a likelihood map with,</p>
<p>$$L = \left( \frac{1}{2 \pi \sigma^2}\right)^{\frac{nw}{2}}
\exp \left(-w n \frac{MSE}{2\sigma^2} \right) \left[z_{mask}&gt;T \right],$$</p>
<p>where \(\sigma\) is the standard deviation (<code>sd</code>) of pressure and \(T\) is the mask threshold
(<code>thr_mask</code>).</p>
<p>Because the auto-correlation of the time series is not accounted for in this equation, we use a
log-linear pooling weight of \(w=\log(n)/n\) by default, where \(n\) is the number of samples
in the time series (i.e., data points used to compute the MSE). See <a href="https://raphaelnussbaumer.com/GeoPressureManual/probability-aggregation.html" class="external-link">GeoPressureManual | Probability aggregation </a> for details.</p>
<p><strong>Important Note</strong>: Since GeoPressure v3.1.0, the threshold of the mask is happening directly
on the GEE server (i.e., during <code>geopressure_map_mismatch()</code>). This allows to compute the MSE
only for pixels which are within the threshold, thus reducing the computational cost
significantly.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Nussbaumer, Raphaël, Mathieu Gravey, Martins Briedis, and Felix Liechti. 2023.
Global Positioning with Animal‐borne Pressure Sensors. <em>Methods in Ecology and Evolution</em>, 14,
1118–1129 <a href="https://doi.org/10.1111/2041-210X.14043" class="external-link">https://doi.org/10.1111/2041-210X.14043</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="https://bit.ly/3sg7yFJ" class="external-link">GeoPressureManual</a></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">owd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">setwd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"GeoPressureR"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tag</span> <span class="op">&lt;-</span> <span class="fu"><a href="tag_create.html">tag_create</a></span><span class="op">(</span><span class="st">"18LX"</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="tag_label.html">tag_label</a></span><span class="op">(</span>quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="tag_set_map.html">tag_set_map</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    extent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">16</span>, <span class="fl">23</span>, <span class="fl">0</span>, <span class="fl">50</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    scale <span class="op">=</span> <span class="fl">4</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">setwd</a></span><span class="op">(</span><span class="va">owd</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">tag</span> <span class="op">&lt;-</span> <span class="fu">geopressure_map_mismatch</span><span class="op">(</span><span class="va">tag</span>,</span></span>
<span class="r-in"><span>  max_sample <span class="op">=</span> <span class="fl">50</span>,</span></span>
<span class="r-in"><span>  margin <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>  thr_mask <span class="op">=</span> <span class="fl">0.95</span>,</span></span>
<span class="r-in"><span>  keep_mask <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  quiet <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in httr2::req_perform(req):</span> Failed to parse error body with method defined in `req_error()`.</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">Caused by error in `httr2::resp_body_json()`:</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">!</span> Unexpected content type "text/html".</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> Expecting type "application/json" or suffix "json".</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tag</span>, type <span class="op">=</span> <span class="st">"map_pressure_mse"</span>, plot_leaflet <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> tag does not have all of these name(s): 'map_pressure_mse'</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tag</span>, type <span class="op">=</span> <span class="st">"map_pressure_mask"</span>, plot_leaflet <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> tag does not have all of these name(s): 'map_pressure_mask'</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">tag</span> <span class="op">&lt;-</span> <span class="fu">geopressure_map_likelihood</span><span class="op">(</span><span class="va">tag</span>,</span></span>
<span class="r-in"><span>  sd <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>  log_linear_pooling_weight <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">/</span> <span class="va">n</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in tag_assert(tag, "map_pressure_mse"):</span> <span style="color: #BB0000;">✖</span> The pressure mean square error map has not yet been computed for</span>
<span class="r-err co"><span class="r-pr">#&gt;</span>   `tag`.</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> → Use `geopressure_map_mismatch()` to compute the maps.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tag</span>, type <span class="op">=</span> <span class="st">"map_pressure"</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> tag does not have all of these name(s): 'map_pressure'</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Raphaël Nussbaumer, Mathieu Gravey.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

