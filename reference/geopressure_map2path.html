<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Find the location of the highest value in the map and return a path data.frame containing the
latitude and longitude. interp can be used to interpolate unrealistic position from short
stationary period based on the position of the longer ones. The interpolation assumes that the
first and last stationary period can be safely estimated from the probability map."><title>Return the most likely path from a probability map — geopressure_map2path • GeoPressureR</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Return the most likely path from a probability map — geopressure_map2path"><meta property="og:description" content="Find the location of the highest value in the map and return a path data.frame containing the
latitude and longitude. interp can be used to interpolate unrealistic position from short
stationary period based on the position of the longer ones. The interpolation assumes that the
first and last stationary period can be safely estimated from the probability map."><meta property="og:image" content="https://raphaelnussbaumer.com/GeoPressureR/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">GeoPressureR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-part-pressure">Part 1: Pressure</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-part-pressure">
    <a class="dropdown-item" href="../articles/labelling-tracks.html">1. Labelling Tracks</a>
    <a class="dropdown-item" href="../articles/pressure-map.html">2. Pressure Map</a>
    <a class="dropdown-item" href="../articles/light-map.html">3. Light Map</a>
    <a class="dropdown-item" href="../articles/probability-aggregation.html">Probability Aggregation</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-part-trajectory">Part 2: Trajectory</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-part-trajectory">
    <a class="dropdown-item" href="../articles/preparing-data.html">1. Preparing Data</a>
    <a class="dropdown-item" href="../articles/basic-graph.html">2. Basic Graph</a>
    <a class="dropdown-item" href="../articles/wind-graph.html">3. Wind Graph</a>
    <a class="dropdown-item" href="../articles/gridded-gibbs.html">Gridded Gibbs</a>
  </div>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">reference</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Rafnuss/GeoPressureTemplate">Start your own study</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Rafnuss/GeoPressureR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Return the most likely path from a probability map</h1>
      <small class="dont-index">Source: <a href="https://github.com/Rafnuss/GeoPressureR/blob/HEAD/R/geopressure.R" class="external-link"><code>R/geopressure.R</code></a></small>
      <div class="d-none name"><code>geopressure_map2path.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Find the location of the highest value in the map and return a path data.frame containing the
latitude and longitude. <code>interp</code> can be used to interpolate unrealistic position from short
stationary period based on the position of the longer ones. The interpolation assumes that the
first and last stationary period can be safely estimated from the probability map.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">geopressure_map2path</span><span class="op">(</span><span class="va">map</span>, interp <span class="op">=</span> <span class="fl">0</span>, format <span class="op">=</span> <span class="st">"lonlat"</span><span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>map</dt>
<dd><p>list of raster containing probability map of each stationary period. The metadata of
<code>map</code> needs to include the start and end time of the stationary period .</p></dd>
<dt>interp</dt>
<dd><p>(in days) The position of the stationary period shorter than <code>interp</code> will be
replace by a linear average from other position.</p></dd>
<dt>format</dt>
<dd><p>one of <code>"lonlat"</code>, <code>"ind"</code>, <code>"arr.ind"</code>). return the path in lon-lat or indices</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a data.frame of the position containing latitude (<code>lat</code>), longitude (<code>lon</code>) and the
stationary period id (<code>sta_id</code>) as column. Optionally, if indexes were requested, it will be
return. You will need to use <code>which.max(as.matrix(raster))</code> and not <code>which.max(raster)</code> to get
the correct location</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"18LX_pressure_prob.rda"</span>, package <span class="op">=</span> <span class="st">"GeoPressureR"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">path_all</span> <span class="op">&lt;-</span> <span class="fu">geopressure_map2path</span><span class="op">(</span><span class="va">pressure_prob</span><span class="op">)</span></span>
<span class="r-in"><span class="va">path_interp</span> <span class="op">&lt;-</span> <span class="fu">geopressure_map2path</span><span class="op">(</span><span class="va">pressure_prob</span>, interp <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span class="r-in"><span class="va">sta_duration</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">pressure_prob</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/difftime.html" class="external-link">difftime</a></span><span class="op">(</span><span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/metadata.html" class="external-link">metadata</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">temporal_extent</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span class="r-in">    <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/metadata.html" class="external-link">metadata</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">temporal_extent</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span class="r-in">    units <span class="op">=</span> <span class="st">"days"</span></span>
<span class="r-in">  <span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu">leaflet</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/leaflet.html" class="external-link">leaflet</a></span><span class="op">(</span>width <span class="op">=</span> <span class="st">"100%"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu">leaflet</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/addProviderTiles.html" class="external-link">addProviderTiles</a></span><span class="op">(</span><span class="va">m</span>, <span class="fu">leaflet</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/leaflet/man/providers.html" class="external-link">providers</a></span><span class="op">$</span><span class="va">Stamen.TerrainBackground</span><span class="op">)</span></span>
<span class="r-in"><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu">leaflet.extras</span><span class="fu">::</span><span class="fu"><a href="https://bhaskarvk.github.io/leaflet.extras/reference/fullscreen.html" class="external-link">addFullscreenControl</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span>
<span class="r-in"><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu">leaflet</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/map-layers.html" class="external-link">addPolylines</a></span><span class="op">(</span><span class="va">m</span>,</span>
<span class="r-in">  lng <span class="op">=</span> <span class="va">path_all</span><span class="op">$</span><span class="va">lon</span>, lat <span class="op">=</span> <span class="va">path_all</span><span class="op">$</span><span class="va">lat</span>, opacity <span class="op">=</span> <span class="fl">1</span>,</span>
<span class="r-in">  color <span class="op">=</span> <span class="st">"#a6cee3"</span>, weight <span class="op">=</span> <span class="fl">3</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu">leaflet</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/map-layers.html" class="external-link">addCircles</a></span><span class="op">(</span><span class="va">m</span>,</span>
<span class="r-in">  lng <span class="op">=</span> <span class="va">path_all</span><span class="op">$</span><span class="va">lon</span>, lat <span class="op">=</span> <span class="va">path_all</span><span class="op">$</span><span class="va">lat</span>, opacity <span class="op">=</span> <span class="fl">1</span>,</span>
<span class="r-in">  color <span class="op">=</span> <span class="st">"#1f78b4"</span>, weight <span class="op">=</span> <span class="va">sta_duration</span><span class="op">^</span><span class="op">(</span><span class="fl">0.3</span><span class="op">)</span> <span class="op">*</span> <span class="fl">10</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu">leaflet</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/map-layers.html" class="external-link">addPolylines</a></span><span class="op">(</span><span class="va">m</span>,</span>
<span class="r-in">  lng <span class="op">=</span> <span class="va">path_interp</span><span class="op">$</span><span class="va">lon</span>, lat <span class="op">=</span> <span class="va">path_interp</span><span class="op">$</span><span class="va">lat</span>, opacity <span class="op">=</span> <span class="fl">1</span>,</span>
<span class="r-in">  color <span class="op">=</span> <span class="st">"#b2df8a"</span>, weight <span class="op">=</span> <span class="fl">3</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu">leaflet</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/map-layers.html" class="external-link">addCircles</a></span><span class="op">(</span><span class="va">m</span>,</span>
<span class="r-in">  lng <span class="op">=</span> <span class="va">path_interp</span><span class="op">$</span><span class="va">lon</span>, lat <span class="op">=</span> <span class="va">path_interp</span><span class="op">$</span><span class="va">lat</span>, opacity <span class="op">=</span> <span class="fl">1</span>,</span>
<span class="r-in">  color <span class="op">=</span> <span class="st">"#33a02c"</span>, weight <span class="op">=</span> <span class="va">sta_duration</span><span class="op">^</span><span class="op">(</span><span class="fl">0.3</span><span class="op">)</span> <span class="op">*</span> <span class="fl">10</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"><span class="va">m</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in x$width %||% settings$fig.width * settings$dpi:</span> non-numeric argument to binary operator</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Raphaël Nussbaumer, Mathieu Gravey.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer></div>

  

  

  </body></html>

