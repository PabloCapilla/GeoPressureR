<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function returns, for each stationary period, two maps of mismatch between the pressure
measured by the geolocator and the ERA5 pressure database."><title>Request and download mismatch maps from pressure data — geopressure_map_mismatch • GeoPressureR</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Request and download mismatch maps from pressure data — geopressure_map_mismatch"><meta property="og:description" content="This function returns, for each stationary period, two maps of mismatch between the pressure
measured by the geolocator and the ERA5 pressure database."><meta property="og:image" content="https://raphaelnussbaumer.com/GeoPressureR/logo.png"><meta name="robots" content="noindex"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=M5FY4BPHTB"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'M5FY4BPHTB');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">GeoPressureR</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">3.0.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Rafnuss/GeoPressureR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Request and download mismatch maps from pressure data</h1>
      <small class="dont-index">Source: <a href="https://github.com/Rafnuss/GeoPressureR/blob/HEAD/R/geopressure_map_mismatch.R" class="external-link"><code>R/geopressure_map_mismatch.R</code></a></small>
      <div class="d-none name"><code>geopressure_map_mismatch.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function returns, for each stationary period, two maps of mismatch between the pressure
measured by the geolocator and the ERA5 pressure database.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">geopressure_map_mismatch</span><span class="op">(</span></span>
<span>  <span class="va">tag</span>,</span>
<span>  max_sample <span class="op">=</span> <span class="fl">250</span>,</span>
<span>  margin <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  timeout <span class="op">=</span> <span class="fl">60</span> <span class="op">*</span> <span class="fl">5</span>,</span>
<span>  workers <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  compute_known <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  debug <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>tag</dt>
<dd><p>a GeoPressureR <code>tag</code> object</p></dd>


<dt>max_sample</dt>
<dd><p>The computation of the maps is only performed on <code>max_sample</code> datapoints of
pressure to reduce computational time. The samples are randomly (uniformly) selected on the
timeseries.</p></dd>


<dt>margin</dt>
<dd><p>The margin is used in the mask map to accept measurement errors, small-scale
topography, and vertical movements of the bird (unit in meters, 1hPa~10m).</p></dd>


<dt>timeout</dt>
<dd><p>Duration before the code is interrupted both for the request on
GeoPressureAPI and GEE (in seconds, see <code><a href="https://httr.r-lib.org/reference/timeout.html" class="external-link">httr::timeout()</a></code>).</p></dd>


<dt>workers</dt>
<dd><p>Number of parallel requests on GEE. Integer between 1 and 99. <code>"auto"</code> adjust the
number of workers to the number of <code>stap_elev</code> to query.</p></dd>


<dt>compute_known</dt>
<dd><p>logical defining if the map(s) for known stationary period should be
estimated based on twilight or hard defined by the known location <code>stap$known_l**</code></p></dd>


<dt>debug</dt>
<dd><p>logical to display additional information to debug a request</p></dd>


<dt>quiet</dt>
<dd><p>logical to hide messages about the progress</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>These maps are generated on Google Earth Engine via the map entry point of the
<a href="https://raphaelnussbaumer.com/GeoPressureAPI/#description" class="external-link">GeoPressure API</a>. The computation
performed by this function consists of the following:</p><ol><li><p>Send a request to generate the Google Earth Engine (GEE) URL of the code producing the maps
for each stationary period separately.</p></li>
<li><p>Download and read these geotiff maps as matrix. The computation on GEE only happens in this
second step when fetching the URL.</p></li>
</ol><p>The maps of each stationary period are returned in two layers:</p><ol><li><p>The Mean Square Error (MSE) between the data logger pressure timeseries and the reanalysis.
The mean error is removed because we assume no specific altitude of the geolocator, thus
allowing an altitudinal shift of the pressure timeseries.</p></li>
<li><p>The mask of the proportion of pressure measurements corresponding to altitude values
found within the min and max ground elevation at each location. The altitude value
of the geolocator pressure timeseries is computed with the barometric formula accounting for the
temporal variation of pressure (surface-pressure) and temperature (2m-temperature) based on
ERA5 data. The min and max ground elevation of each pixel is computed from SRTM-90.</p></li>
</ol><p>For each stationary period, the pressure measurements are smoothed and downscaled to a 1-hour
resolution in order to match ERA-5 resolution.</p>
<p>It is possible to indicate different elevation levels when the bird was spending time at
locations with different elevations within a general area (~10km), and thus within the same
stationary period. This can be done by using <code>tag$label="elev_n"</code>for all measurements of the same
elevation level <em>n</em>.</p>
<p>For more background and details on this algorithm, please refer to Nussbaumer et al. (<a href="https://doi.org/10.1111/2041-210X.14043" class="external-link">2023a </a>) and the <a href="https://raphaelnussbaumer.com/GeoPressureAPI/" class="external-link">GeoPressure API documentation </a>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Nussbaumer, Raphaël, Mathieu Gravey, Martins Briedis, and Felix Liechti. 2023.
Global Positioning with Animal‐borne Pressure Sensors. <em>Methods in Ecology and Evolution</em>, 14,
1118–1129 <a href="https://doi.org/10.1111/2041-210X.14043" class="external-link">https://doi.org/10.1111/2041-210X.14043</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="https://bit.ly/3sfQjV6" class="external-link">GeoPressureManual</a>, <a href="https://raphaelnussbaumer.com/GeoPressureAPI/" class="external-link">GeoPressure API </a>.</p>
<p>Other geopressure_map: 
<code><a href="geopressure_map_likelihood.html">geopressure_map_likelihood</a>()</code>,
<code><a href="geopressure_map.html">geopressure_map</a>()</code></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Raphaël Nussbaumer, Mathieu Gravey.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

